########################################################################################
#   HENRY'S HYPRLAND CONFIG (Final)
#   - Shadow Fixed (v0.45+)
#   - Global Opaque (Transparency per-app)
#   - Pywal Colors Fixed
########################################################################################

# --- 1. COLORS ---
# Source this AT THE TOP. If missing, run 'wal -i image.jpg'
source = ~/.cache/wal/colors-hyprland.conf

# --- 2. MONITORS ---
# Your Specific High-Res Setup
monitor=DP-1,2560x1440@360,0x0,1,vrr,2
monitor=DP-2,1920x1080@144,320x-1080,1
# Laptop/Fallback
monitor=eDP-1,preferred,auto,1.25
monitor=,preferred,auto,1

# --- 3. PROGRAMS ---
$terminal    = alacritty
$fileManager = nautilus
$menu        = rofi -show drun
$browser     = firefox

# --- 4. AUTOSTART ---
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec-once = dunst &
exec-once = waybar &
exec-once = swww-daemon &
exec-once = wl-paste --watch cliphist store
exec-once = nm-applet --indicator
exec-once = ~/.config/nwg-dock-hyprland/launch.sh

# --- 5. ENVIRONMENT ---
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = QT_QPA_PLATFORMTHEME,qt5ct
env = GTK_THEME,Materia-dark-compact

# --- 6. INPUT ---
input {
    kb_layout = us
    follow_mouse = 1
    sensitivity = 0
    touchpad {
        natural_scroll = false
    }
}

# --- 7. GENERAL ---
general {
    gaps_in = 5
    gaps_out = 10
    border_size = 2
    
    # Colors from Pywal
    col.active_border = $color11 $color14 45deg
    col.inactive_border = $color0

    layout = dwindle
    resize_on_border = true 
}

# --- 8. DECORATION (FIXED) ---
decoration {
    rounding = 10
    
    # GLOBAL OPACITY: All windows opaque by default.
    # Alacritty handles its own transparency via alacritty.toml
    active_opacity = 1.0
    inactive_opacity = 1.0

    # SHADOWS (New Syntax for v0.45+)
    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1
        vibrancy = 0.1696
        xray = false
    }
}

# --- 9. ANIMATIONS ---
animations {
    enabled = yes
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 5, myBezier
    animation = windowsOut, 1, 5, default, popin 80%
    animation = border, 1, 10, default
    animation = fade, 1, 5, default
    animation = workspaces, 1, 5, default
}

# --- 10. LAYOUTS ---
dwindle {
    pseudotile = yes
    preserve_split = yes
}

# --- 11. WINDOW RULES ---
windowrulev2 = suppressevent maximize, class:.*
# Floating windows
windowrulev2 = float, class:(pavucontrol)
windowrulev2 = float, class:(waypaper)
windowrulev2 = float, title:(Picture-in-Picture)
windowrulev2 = float, class:(org.gnome.Calculator)

# Waybar Blur (Keep this for aesthetics)
layerrule = blur, waybar
layerrule = ignorealpha 0.5, waybar
layerrule = blur, rofi

# --- 12. KEYBINDINGS ---
$mainMod = SUPER

# Apps
bind = $mainMod, A, exec, $terminal
bind = $mainMod, F, exec, $browser
bind = $mainMod, TAB, exec, $fileManager
bind = $mainMod, SPACE, exec, $menu
bind = $mainMod, D, exec, vesktop
bind = $mainMod, S, exec, spotify
bind = $mainMod CTRL, S, exec, steam

# System
bind = $mainMod, W, killactive
bind = $mainMod, V, togglefloating
bind = $mainMod, P, pseudo, 
bind = $mainMod, J, togglesplit, 
bind = $mainMod SHIFT, M, exit, 

# Screenshot
bind = , Print, exec, grimblast copy area

# Focus
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# Workspaces
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6

bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6

# Mouse
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Screen Lock
bind = $mainMod, L, exec, hyprlock
